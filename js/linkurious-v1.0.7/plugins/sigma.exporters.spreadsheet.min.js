(function(a){"use strict";function b(a){throw"sigma.exporters.spreadsheet: "+a}function c(a,b,c){var d=document.createElement("a");d.setAttribute("href",a),d.setAttribute("download",c||"graph."+b);var e=document.createEvent("MouseEvent");e.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),d.dispatchEvent(e),d.remove()}function d(b,c){return null===b||b===a?c+c:("function"==typeof b&&(b=b.toString()),b="string"==typeof b?b:JSON.stringify(b),b=b.replace(/\s+/g," "),c&&c.length?c+b.replace(c,'"'===c?"'":'"')+c:b)}function e(b,c){return null===c||c===a?null:c.split(".").reduce(function(a,b){return a[b]},b)}if("undefined"==typeof sigma)throw"sigma.exporters.spreadsheet: sigma is not declared";sigma.prototype.toSpreadsheet=function(a){a=a||{},a.separator=a.separator||",",a.textSeparator=a.textSeparator||"",a.textSeparator&&'"'!==a.textSeparator&&"'"!==a.textSeparator&&b('Wrong argument "textSeparator": '+a.textSeparator);var f,g,h,i=[],j={},k=[],l=0;a.what||b('Missing argument "what".'),"nodes"===a.what?f=a.which?this.graph.nodes(a.which):this.graph.nodes():"edges"===a.what?f=a.which?this.graph.edges(a.which):this.graph.edges():b('Wrong argument "what": '+a.what),j.id=l++,k.push(d("id",a.textSeparator)),"edges"===a.what&&(j.source=l++,k.push(d("source",a.textSeparator)),j.target=l++,k.push(d("target",a.textSeparator)));for(var m=0;m<f.length;m++)h=f[m],g=e(h,a.attributes)||{},Object.keys(g).forEach(function(b){b in j||(j[b]=l++,k.push(d(b,a.textSeparator)))});i.push(k);for(var m=0;m<f.length;m++){h=f[m];var n=[];n.length=l,n[0]=d(h.id,a.textSeparator),"edges"===a.what&&(n[1]=d(h.source,a.textSeparator),n[2]=d(h.target,a.textSeparator)),g=e(h,a.attributes)||{},Object.keys(g).forEach(function(b){n[j[b]]=d(g[b],a.textSeparator)}),i.push(n)}var o=i.map(function(b){return b.join(a.separator)}).join("\n");return a.download&&c("data:text/csv;charset=UTF-8,"+encodeURIComponent(o),"csv",a.filename),o}}).call(this);
//# sourceMappingURL=sigma.exporters.spreadsheet.min.js.map