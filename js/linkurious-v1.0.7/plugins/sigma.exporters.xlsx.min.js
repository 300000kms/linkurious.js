(function(a){"use strict";function b(a){throw"sigma.exporters.xlsx: "+a}function c(a,b,c){var d=document.createElement("a");d.setAttribute("href",a),d.setAttribute("download",c||"graph."+b);var e=document.createEvent("MouseEvent");e.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),d.dispatchEvent(e),d.remove()}function d(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d!=a.length;++d)c[d]=255&a.charCodeAt(d);return b}function e(b){return null===b||b===a?"":("function"==typeof b&&(b=b.toString()),"number"!=typeof b&&(b="string"==typeof b?b:JSON.stringify(b)),b)}function f(b,c){return null===c||c===a?null:c.split(".").reduce(function(a,b){return a[b]},b)}function g(){return this instanceof g?(this.SheetNames=[],void(this.Sheets={})):new g}function h(a,b){b&&(a+=1462);var c=Date.parse(a);return(c-new Date(Date.UTC(1899,11,30)))/864e5}function i(a,b){for(var c={},d={s:{c:1e7,r:1e7},e:{c:0,r:0}},e=0;e!=a.length;++e)for(var f=0;f!=a[e].length;++f){d.s.r>e&&(d.s.r=e),d.s.c>f&&(d.s.c=f),d.e.r<e&&(d.e.r=e),d.e.c<f&&(d.e.c=f);var g={v:a[e][f]};if(null!=g.v){var i=XLSX.utils.encode_cell({c:f,r:e});"number"==typeof g.v?g.t="n":"boolean"==typeof g.v?g.t="b":g.v instanceof Date?(g.t="n",g.z=XLSX.SSF._table[14],g.v=h(g.v)):g.t="s",c[i]=g}}return d.s.c<1e7&&(c["!ref"]=XLSX.utils.encode_range(d)),c}function j(a,b){var c,d,g,h=0,i={},j=[],k=[];d="edges"===b.what?b.edgesAttributes:b.nodesAttributes,i.id=h++,j.push("id"),"edges"===b.what&&(i.source=h++,j.push("source"),i.target=h++,j.push("target"));for(var l=0;l<a.length;l++)g=a[l],c=f(g,d)||{},Object.keys(c).forEach(function(a){a in i||(i[a]=h++,j.push(e(a)))});k.push(j);for(var l=0;l<a.length;l++){g=a[l];var m=[];m.length=h,m[0]=e(g.id),"edges"===b.what&&(m[1]=e(g.source),m[2]=e(g.target)),c=f(g,d)||{},Object.keys(c).forEach(function(a){m[i[a]]=e(c[a])}),k.push(m)}return k}if("undefined"==typeof sigma)throw"sigma.exporters.xlsx: sigma is not declared";if("undefined"==typeof XLSX)throw"sigma.exporters.xlsx: XLSX is not declared";sigma.prototype.toXLSX=function(a){a=a||{};var e,f,h,k=new g;a.what?"nodes"===a.what?(h=a.which?this.graph.nodes(a.which):this.graph.nodes(),e=i(j(h,a))):"edges"===a.what?(h=a.which?this.graph.edges(a.which):this.graph.edges(),f=i(j(h,a))):b('Wrong argument "what": '+a.what):(a.what="nodes",e=i(j(this.graph.nodes(),a)),a.what="edges",f=i(j(this.graph.edges(),a))),e&&(k.SheetNames.push("Nodes"),k.Sheets.Nodes=e),f&&(k.SheetNames.push("Edges"),k.Sheets.Edges=f);var l=XLSX.write(k,{bookType:"xlsx",bookSST:!1,type:"binary"}),m=new Blob([d(l)],{type:""});c(URL.createObjectURL(m),"xlsx",a.filename)}}).call(this);
//# sourceMappingURL=sigma.exporters.xlsx.min.js.map