<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="../js/linkurious-v1.0.7/sigma.min.js"></script>
</head>
<body>
<div id="container">
    <style>
        #graph-container {
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            position: absolute;
        }
    </style>
    <div id="graph-container"></div>
</div>
<script>

    function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                results = regex.exec(location.search);
        return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }

    var
        queryClusters = getParameterByName('clusters'),
        queryNodeByCluster = getParameterByName('nodeByCluster'),
        queryEdges = getParameterByName('edgesInterCluster'),
        queryClusterRatio = getParameterByName('clusterRatio'),
        queryNodeSize = getParameterByName('nodeSize');

    var i,
        clusterCenterArray = [],
        nodeSize = (queryNodeSize !== '') ? parseFloat(queryNodeSize) : 8,
        clusterCenters = (queryClusters !== '') ? parseInt(queryClusters, 10) : 20,
        clusterSize = (queryClusterRatio !== '') ? parseFloat(queryClusterRatio) : 0.05,
        N = (queryNodeByCluster !== '') ? parseInt(queryNodeByCluster, 10) : 20,
        E = (queryEdges !== '') ? parseInt(queryEdges, 10) : 20,
        g = {
            nodes: [],
            edges: []
        };
    // Generate a random graph:
    for (i = 0; i < N * clusterCenters; i = i + N) {
        g.nodes.push({
            id: 'n' + i,
            x: Math.random() * window.innerWidth,
            y: Math.random() * window.innerHeight,
            size: Math.random(),
            color: '#f55564'
        });

        clusterCenterArray.push(g.nodes[i]);

        for (var j =  i + 1 ; j < i + N ; j++){
            g.nodes.push({
                id: 'n' + j,
                x: (Math.floor(Math.random() * 2) == 1 ? 1 : -1) * Math.random() * clusterSize * window.innerWidth  + g.nodes[i].x,
                y: (Math.floor(Math.random() * 2) == 1 ? 1 : -1) * Math.random() * clusterSize * window.innerHeight + g.nodes[i].y,
                size: Math.random(),
                color: '#f55564'
            });

            g.edges.push({
                id: 'e' + (j - 1),
                source: 'n' + i,
                target: 'n' + j,
                size: Math.random(),
                color: '#ccc'
            });
        }
    }

    var
        sourceIndex = 0,
        targetIndex = 0,
        lastIndex = g.edges.length + clusterCenters + E ;

    for (i = g.edges.length + clusterCenters + 1 ; i < lastIndex; i++){
        sourceIndex = Math.floor(Math.random() * clusterCenterArray.length);
        targetIndex = Math.floor(Math.random() * clusterCenterArray.length);

        g.edges.push({
            id: 'e' + i,
            source: clusterCenterArray[sourceIndex].id,
            target: clusterCenterArray[targetIndex].id,
            size: Math.random(),
            color: '#ccc'
        });
    }

    // Instantiate sigma:
    var s = new sigma({
        graph: g,
        container: 'graph-container',
        settings: {
            maxNodeSize: nodeSize
        }
    });
</script>
</body>
</html>
